package com.geriatriccare.enums;

/**
 * Audit Event Type Enumeration
 * Types of events that are logged in the audit trail
 * From Sprint 5: Security & Compliance
 */
public enum AuditEventType {
    // Authentication & Authorization
    LOGIN_SUCCESS,
    LOGIN_FAILED,
    LOGOUT,
    MFA_ENABLED,
    MFA_DISABLED,
    MFA_VERIFIED,
    PASSWORD_CHANGED,
    PASSWORD_RESET_REQUESTED,
    SESSION_CREATED,
    SESSION_EXPIRED,
    
    // User Management (Sprint 6)
    USER_CREATED,
    USER_UPDATED,
    USER_DELETED,
    USER_ACTIVATED,
    USER_ROLE_CHANGED,
    USER_EMAIL_VERIFIED,
    
    // Data Access
    DATA_ACCESSED,
    DATA_CREATED,
    DATA_UPDATED,
    DATA_DELETED,
    
    // Patient Operations
    PATIENT_CREATED,
    PATIENT_UPDATED,
    PATIENT_ACCESSED,
    PATIENT_DELETED,
    
    // Medication Operations
    MEDICATION_PRESCRIBED,
    MEDICATION_UPDATED,
    MEDICATION_DELETED,
    MEDICATION_ADMINISTERED,
    
    // AI Operations
    AI_RECOMMENDATION_GENERATED,
    AI_RECOMMENDATION_APPROVED,
    AI_RECOMMENDATION_REJECTED,
    
    // System & Configuration
    CONFIG_CHANGED,
    SYSTEM_ERROR,
    SECURITY_VIOLATION,
    
    // Compliance
    AUDIT_LOG_ACCESSED,
    REPORT_GENERATED,
    DATA_EXPORTED,
    
    // Emergency
    EMERGENCY_ACTIVATED,
    EMERGENCY_RESOLVED
    ,
    // Additional Sprint 5 events
    PHI_VIEW,
    LOGIN_FAILURE,
    UNAUTHORIZED_ACCESS

    /**
     * Check if this event type is PHI-related
     */
    public boolean isPHIEvent() {
        return this == DATA_ACCESSED || 
               this == PATIENT_ACCESSED || 
               this == MEDICATION_PRESCRIBED ||
               this == MEDICATION_UPDATED ||
               this == PATIENT_CREATED ||
               this == PATIENT_UPDATED;
    }

    /**
     * Check if this event type is security-critical
     */
    public boolean isSecurityCritical() {
        return this == LOGIN_FAILED || 
               this == SECURITY_VIOLATION || 
               this == EMERGENCY_ACTIVATED;
    }

    /**
     * Get display name for UI
     */
    public String getDisplayName() {
        return name().replace("_", " ").toLowerCase()
            .replaceAll("\b[a-z]", m -> m.toUpperCase());
    }
}
